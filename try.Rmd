---
title: "try"
knit: (function(input_file, encoding) {
  out_dir <- 'docs';
  rmarkdown::render(input_file,
  encoding=encoding,
  output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
author: "Valerii"
date: "21 03 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
```{r}
library(shiny)
library(ggplot2)
ui <- fluidPage(
  titlePanel("Influence of drugs legalization on mortality"),
  sidebarLayout(
    sidebarPanel(
      sliderInput(inputId = "Year",
                  label = "year",
                  min = 1999,
                  max = 2018,
                  value = 1999)
    ),
    mainPanel(
      plotOutput("drugmap",width = "80%")
      
    )
  )
)
states_map <- map_data("state")
server <- function(input, output) {
  output$drugmap <- renderPlot({
    ggplot(subset(panel_data, year == input$Year), aes(map_id = tolower(state))) + 
      geom_map(aes(fill = opioid_death_rate,  label = med), map = states_map) + 
      expand_limits(x = states_map$long, y = states_map$lat)+theme_bw()+theme(panel.grid = element_blank(), legend.position = "bottom")
  })
  
}
shinyApp(ui, server)






```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
